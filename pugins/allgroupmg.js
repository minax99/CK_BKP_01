
const { cmd, commands } = require('../command');

cmd({
  pattern: "msgall",
  desc: "Group ‡∂ë‡∂ö‡∑ö ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö‡∂∫‡∑í‡∂±‡∑ä‡∂ß Inbox ‡∑Ä‡∂Ω‡∂ß ‡∂ë‡∂ö‡∂∏ ‡∂¥‡∂´‡∑í‡∑Ä‡∑í‡∂©‡∂∫ ‡∂∫‡∑Ä‡∂∫‡∑í.",
  category: "‡∑É‡∂∏‡∑ñ‡∑Ñ",
  react: "üì©",
  use: ".tagall [message]",
  filename: __filename
}, async (conn, mek, m, { from, q, isGroup, groupMetadata, participants, isOwner, isAdmins, groupAdmins, reply }) => {
  try {
    if (!isGroup) {
      return reply("*`‡∂∏‡∑ô‡∂∏ ‡∑Ä‡∑í‡∂∞‡∑è‡∂±‡∂∫ Group ‡∑Ä‡∂Ω‡∂Ø‡∑ì ‡∂¥‡∂∏‡∂´‡∂ö‡∑ä ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∑Ö ‡∑Ñ‡∑ê‡∂ö`*");
    }
    if (!isOwner && !isAdmins) {
      return reply("*`‡∂∏‡∑ô‡∂∏ ‡∑Ä‡∑í‡∂∞‡∑è‡∂±‡∂∫ Bot ‡∑Ñ‡∑í‡∂∏‡∑í‡∂ö‡∂ª‡∑î‡∂ß ‡∑Ñ‡∑ù Admin ‡∂Ω‡∑è‡∂ß ‡∂¥‡∂∏‡∂´‡∂∫‡∑í`*");
    }
    if (!participants || participants.length === 0) {
      return reply("*`‡∂∏‡∑ô‡∂∏ Group ‡∂ë‡∂ö‡∑ö ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö‡∂∫‡∑í‡∂±‡∑ä ‡∂±‡∑ê‡∂≠`*");
    }

    // Custom Message ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂Ω‡∂∂‡∑è‡∂Ø‡∑î‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∂≠‡∑ä‡∂±‡∂∏‡∑ä Default Message ‡∂ë‡∂ö‡∂ö‡∑ä
    const customMessage = q ? q : "Group ‡∂ë‡∂ö‡∑ö ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∂Ø‡∑ô‡∂±‡∑è‡∂ß ‡∂Ü‡∂∫‡∑î‡∂∂‡∑ù‡∑Ä‡∂±‡∑ä! üëã";

    // Group ‡∂ë‡∂ö‡∑ö ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö‡∂∫‡∑í‡∂±‡∑ä‡∂ß Inbox ‡∑Ä‡∂Ω‡∂ß Message ‡∂∫‡∑ê‡∑Ä‡∑ì‡∂∏
    let sentCount = 0;
    const totalMembers = participants.length;

    for (let participant of participants) {
      const targetJid = participant.id;
      const isAdmin = groupAdmins.includes(targetJid);
      const inboxMessage = `
*üì© Group Message: ${groupMetadata.subject}*

*Message:* _${customMessage}_


> *·¥ò·¥è·¥°·¥á Ä·¥Ö  ô è  ·¥ã·¥Ä·¥†…™·¥Ö·¥ú  Ä·¥ÄÍú±·¥Ä…¥…¢·¥Ä : )*
`;

      try {
        await conn.sendMessage(targetJid, { text: inboxMessage }, { quoted: mek });
        sentCount++;
      } catch (e) {
        console.error(`Inbox ‡∂∫‡∑ê‡∑Ä‡∑ì‡∂∏‡∑ö ‡∂Ø‡∑ù‡∑Ç‡∂∫ ${targetJid}:`, e);
      }
    }

    // ‡∂≠‡∑Ñ‡∑Ä‡∑î‡∂ª‡∑î ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∑ö ‡∂¥‡∂´‡∑í‡∑Ä‡∑í‡∂©‡∂∫ Group ‡∂ë‡∂ö‡∂ß
    await conn.sendMessage(from, {
      text: `*‚úÖ ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä ${sentCount}/${totalMembers} ‡∂Ø‡∑ô‡∂±‡∑ô‡∂ö‡∑î‡∂ß Inbox ‡∑Ä‡∂Ω‡∂ß ‡∂¥‡∂´‡∑í‡∑Ä‡∑í‡∂©‡∂∫ ‡∂∫‡∑Ä‡∂± ‡∂Ω‡∂Ø‡∑ì!*\n\n*‡∂¥‡∂´‡∑í‡∑Ä‡∑í‡∂©‡∂∫:* _${customMessage}_\n\n> „ãõÔ∏é ·¥ò·¥è·¥°·¥á Ä·¥Ö  ô è  ·¥Ñ è ô·¥á Ä ·¥Ö…™…¥·¥ú …™·¥Ö`
    }, { quoted: mek });

  } catch (error) {
    console.error("Inbox Message ‡∂∫‡∑ê‡∑Ä‡∑ì‡∂∏‡∑ö ‡∂Ø‡∑ù‡∑Ç‡∂∫:", error);
    reply("*`‡∂Ø‡∑ù‡∑Ç‡∂∫‡∂ö‡∑ä ‡∂á‡∂≠‡∑í ‡∑Ä‡∑í‡∂∫. ‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂±‡∑ê‡∑Ä‡∂≠ ‡∂ã‡∂≠‡∑ä‡∑É‡∑è‡∑Ñ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±`*");
  }
});

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    